---
title: Mysql数据库
date: 2021-03-12 22:58:40
categories: 
- 数据库
---
1.各个数据库/引擎的对比 2.事务/隔离  3.锁  4.索引/调优 5.范式
1.了解不同引擎的特性：
	MYISAM：支持全文索引，缺点：不支持事务，使用表级锁
	InnoDB:支持行级锁(并发性能好)，支持ACID事务，支持外键
	TokuDB非常适合访问频率不高的数据或历史数据归档，不适合大量读取的场景。
2.SQL与NOSQL的区别
	SQL结构化表，NOSQSL多种表伸缩性大，
	SQL使用外键，NOSQL可以使用外键也可以直接添加到原始数据中
	SQL删除有被连接的数据会失败，NOSQL可以
	NOSQL按照KEY查询效率高，特定结构需要SQL
	
1.ACDI的特性，脏读，不可重复读，幻读

　　1.原子性，一致性()，隔离性(不同用户的事务之间当然要隔离)，持久性(数据的修改是永久性，不能丢失)

　　2.脏读：事务A读取了事务B只修改未提交的数据，不可重复读：事务A多次查询，此时事务B修改了数据库，导致A数据变化，幻读：不可重复读的修改变成了增加数据

2.四大隔离级别
	问题：脏读，不可重复读，幻读
　　读未提交(三个问题一个不能解决)，读已提交(只能解决脏读)，可重读(使用MVCC机制)(解决了脏读/不可重复读问题)，可串行化(所有事务会按照次序执行，并发性能极差)
	Mysql默认是可重读隔离
	
	
1.简单了解悲观锁与乐观锁
　　悲观锁：多写少读，读数据的时认为会改数据，给他上锁
　　乐观锁：多读少写，没有锁，所以增加了吞吐量，使用版本号机制和CAS算法
2.MyIASAM使用表级锁，InnoDB使用行级锁。
	表锁开销小，加锁快，不会出现死锁；但是锁的粒度大，发生锁冲突的概率高，并发访问效率比较低。
	行级锁开销大，加锁慢，有可能会出现死锁，不过因为锁定粒度最小，发生锁冲突的概率低，并发访问效率比较高。
	共享锁也就是读锁，其他事务可以读，但不能写。MySQL可以通过Lock In Share Mode语句显示使用共享锁。排他锁就是写锁，其他事务不能读取，也不能写。对于Update、Delete和INSERT语句，InnoDB会自动给涉及的数据集加排他锁，或者使用select for update显示使用排他锁。

范式：
4.版本号机制
每个数据表设置一个version字段，当有数据修改时自动加一，事务要保证读的version与提交的时候一样大

 MyIASAM与InnoDB的区别
	1.MyIASAM只有表锁，InnoDB有行锁也有表锁
	2.M没有事务，I有事务

 3. **Innodb不支持全文索引，而MyISAM支持全文索引**

 4. **InnoDB支持外键，而MyISAM不支持**

 5. I是聚集索引，数据文件与索引不分离，M是非聚集索引，数据文件与索引分离
    I辅助索引B+树叶子节点是主键，然后通过主键查询数据，M辅助索引与主键也是B+树，叶子节点直接是数据文件的地址指针

    

该如何选取M与I：1.MyIASAM优势是查询，2.InnoDB优势是插入与修改

注意：InnoDB中不保存表的行数（eg:select count(*)from table时，InnoDB需要扫描一遍整个表来计算有多少行）；清空整个表时，InnoDB是一行一行的删除，效率非常慢；