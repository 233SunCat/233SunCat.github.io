---
title: TCP三次握手连接与四次释放
date: 2021-03-12 22:58:40
categories: 
- 计算机网络
- TCP
---
三次握手：客户端发送一个SYN请求，服务器回应一个SYN+ACK，客户端回应一个ACK(确认包)
平常来说客户端发送一个请求，服务器响应一个确认包就可以了
问题：客户端请求在网络延迟太高，等发送到服务器时，或许客户端已经关闭，那么服务器就会一直等待浪费资源
解决办法：客户端也要回应一个确认包

SYN是用来同步的，ACK是用来应答的
四次释放
SYN改成FIN
为什么连接只有三步，释放却有四步
在服务器第一次应答时，会发送确认包，但是不会关闭发送端口，因为有可能有数据没发送完
等发送完时，会再向客户端发送一个FIN+ACK
问题：为什么客户端在最后发送确认包要等2MS？
原因：确认又可能网络丢失了，所以在2MSL时间内，服务器没有收到客户端确认包就会反复发送FIN+ACK，所以客户端要等下
解决办法：客户端等待TIME_WAIT=2MSL